# 让“灯”辨明暗

&emsp;&emsp;上一节，我们利用了`触碰传感器`给`LED灯`添加了开关的功能，这样的开灯方式总觉得有点low对吧?本节我们来一起研究如何让灯变得更加智能——让灯自己能够分辨明暗，在适当的时候亮灯。

【视频演示】

## 一、认识光敏传感器

&emsp;&emsp;如何让机器感知到现实环境中的光线强弱呢？这就需要使用`光敏传感器`了。在百度百科中是这样定义`光敏传感器`的。

> 光敏传感器是对外界光信号或光辐射有响应或转换功能的敏感装置。——百度百科

&emsp;&emsp;在OSTD套装中的`光敏传感器`如下图所示。

![光敏传感器示意图](https://gitee.com/wansq0211/markdownImg/raw/master/img/20210409094715.png)



## 二、获取光敏传感器的信息

&emsp;&emsp;`光敏传感器`的连接主控板的时候需要注意，只能连接在模拟接口：`接口4`、`接口5`、`接口6`上。如下图所示：

![连接示意图](https://gitee.com/wansq0211/markdownImg/raw/master/img/20210409094742.png)

&emsp;&emsp;传感器连接之后，要想获取`光敏传感器`的数据，还是可以利用`读模拟值`的控件可以获取光敏传感器的数据，变量搭建输入脚本。

![光敏传感器测试程序](https://gitee.com/wansq0211/markdownImg/raw/master/img/20210416103055.png)

【演示视频】

&emsp;&emsp;可以发现随着光敏传感器附件光线强弱的变化，变量中的数据变化范围很大。

**实验记录表**：

|        | 暗环境 | 亮环境  |
| :----: | :----: | :-----: |
| 光敏值 | 小于50 | 300~400 |

**实验结论**：

* `光敏传感器`传感器的理论数据范围`0~1023`，光线越暗，数据值越小；光线越亮，数据值越大。
  * 注：数值的变化是连续的，我们把这样连续变化的信号叫做`模拟信号`。故`光敏传感器`的接口只能接在`模拟接口4、5、6`上。
* 对于机器来说，环境的光线强弱转化为了光线数值的大小。在实际设计程序的时候，就要关注变量中数据的变化。



## 三、智能灯

### 编程任务1：天黑开灯、天亮关灯

* 功能演示

* 脚本参考

  ![智能灯v1.0版本参考脚本](https://gitee.com/wansq0211/markdownImg/raw/master/img/20210416103145.png)

### 进阶拓展：使用RGB LED灯

&emsp;&emsp;在OSTD开源机器人套装中，提供的LED灯亮度比较低。显然用它来照明是不理想的，由于OSTD的主板是基于Arduino开发的，故我们完全可以在某宝上购买`RGB LED灯`,也就不到10块钱的成本。下图便是`RGB LED灯`：

![RGB LED灯示例](https://gitee.com/wansq0211/markdownImg/raw/master/img/20210416110332.png)

可以发现，RGB LED灯上有4个引脚针，分别标有`-`、`R`、`G`、`B`的标记：

* `-`：接地引脚，可以理解为电源负极。连接在主控板 `GND`引脚；

* `R`：Red，代表红色信号，输出值范围：0~255；

* `G`：Green，代表绿色信号，输出值范围：0~255；

* `B`：Blue，代表蓝色信号，输出值范围：0~255；

  注：红`R`、绿`G`、蓝`B`三种颜色叠加便可以合成其他的颜色，`RGB LED灯`：256级的RGB色彩总共能组合出约1678万种色彩，即256×256×256=16777216。

  ![合成白光图](https://gitee.com/wansq0211/markdownImg/raw/master/img/20210416142757.png)

&emsp;&emsp;如下图所示，利用`杜邦线`将LED灯连接到`物联网扩展板`的引脚`GND`、`~3`、`~5`、`~6`引脚上。注：`~`支持`模拟输出`，在这里可以改变灯的亮度，在《认识LED灯》一课中的**呼吸灯效果**有应用。

![RGB led灯引脚连接](https://gitee.com/wansq0211/markdownImg/raw/master/img/20210416121449.png)

* 功能演示

  

* 脚本参考

  ![智能灯v2.0脚本参考](https://gitee.com/wansq0211/markdownImg/raw/master/img/20210416103250.png)