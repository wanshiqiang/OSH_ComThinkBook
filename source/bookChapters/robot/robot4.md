# 躲避障碍

&emsp;&emsp;上一节，我们已经赋予机器人行走的能力。我们可以指定机器人是前进、后退、转弯、停止。但是在最后的“走正方形”实验中，我们给机器人编写的正方形路线并不是像理论上的那么精确，误差很大。其实这也反映出了机器人编程一个问题：误差。误差来自于现实世界的各种因素，如：左右电机之间的误差、齿轮摩擦的误差、电池电量的误差、、、

&emsp;&emsp;其实，我们人也差不多，如果让你闭上眼睛，沿着一个方向笔直的走下去，你也会很快就偏离轨道的。所以这样一想，是不是觉得机器人还挺委屈的。既然大家都理解了机器人的误差，我们如何帮助机器人运行的更好呢？我们人在行走的时候，除了脚在走，眼睛是不是要看着前方？所以如果要让机器人运行的更符合我们的要求，我们也要给他加上感觉器官——传感器。今天我们就来学习制作“避障机器人”。

&emsp;&emsp;先来研究一下，今天给机器人的感觉器官——超声波传感器。超声波传感器可以帮助机器人获取前方障碍物离它的距离。先来了解一下超声波传感器的原理吧。

【超声波传感器图片】

【原理图】

## 一、感知距离：获取超声波传感器数据
&emsp;&emsp;了解了原理，如何让机器人获取到超声波传感器的数据呢？我们来看看xDing软件中的机器人指令，哪一个跟超声波有关？

【出示xding截图】

&emsp;&emsp;这里有两个与超声波相关的指令，我们用哪一个呢？由于OSTD机器人小车集成了超声波传感器，所以我们就直接使用“板载超声波测距cm”这个指令就可以获取机器人主板上的超声波信息。

&emsp;&emsp;在编程的使用，为了调试方便，我们一般需要加板载超声波测距指令返回的数据存起来，以便观测数据变化。如图所示脚本。

【编程脚本】

## 二、编程任务：紧急制动

&emsp;&emsp;我们现在已经可以获取超声波传感器的数据，机器人要想知道障碍物距离自己的距离，只要读取变量超声波值就可以了。在我们生活中感知前方距离，就有很多应用，我们来看一个汽车上的运用。

（出示视频）

其实超声波+结合上节课机器人的行走就可以做出类似功能，让我们来尝试实现编程任务：紧急制动。如果机器人在前进过程中，遇到障碍物离他很近，能够紧急刹车。

* 拓展1：如果障碍物离开了，机器人等待一会后，再次启动。

* 拓展2：根据距离远近，缓慢减速，防止急停造成对车内人员的伤害。


## 三、自由探索：自走机器人程序
&emsp;&emsp;【出示视频片段：陪伴机器人在家中自由探索。】让机器人自由行走，“超声波+行走”我们也可以实现。大家可以试试看如何设计机器人程序，就可以让机器人在房间里不停的自由行走呢？ 





